# EventHorizon Apache Configuration File
# @file .htaccess
# @brief Apache server configuration for URL rewriting and security
# 
# This file configures Apache to:
# 1. Enable URL rewriting for clean URLs
# 2. Direct all requests through Index.php (front controller)
# 3. Set security headers
# 4. Control caching behavior
#
# @author EventHorizon Team
# @version 1.0
# @note Required: mod_rewrite must be enabled on server

# Enable the rewrite engine
# Required for all URL rewriting rules below
RewriteEngine On

# Set the base directory for rewrites
# Adjust this if application is in a subdirectory
# Example: For /myapp/Index.php use: RewriteBase /myapp/
RewriteBase /

# Security: Prevent access to hidden files and directories
# Blocks access to .git, .env, .config, etc.
RewriteRule "(^|/)\.(?!well-known)" - [F]

# Redirect all requests to Index.php
# This implements the front controller pattern
# 
# Conditions:
# 1. Not a real file (allows CSS, JS, images to load)
RewriteCond %{REQUEST_FILENAME} !-f
# 2. Not a real directory (prevents directory listing)
RewriteCond %{REQUEST_FILENAME} !-d
# 3. Not already Index.php (prevents infinite loop)
RewriteCond %{REQUEST_URI} !^/Index\.php

# The main rewrite rule
# Captures the path and passes as query string
# Example: /event/show/1 â†’ Index.php?url=event/show/1
RewriteRule ^(.*)$ Index.php?url=$1 [QSA,L]

# QSA = Query String Append (preserves GET parameters)
# L = Last rule (stop processing after this match)

# Optional: Security Headers
# Uncomment these for production deployment

# Prevent clickjacking attacks
# Header set X-Frame-Options "SAMEORIGIN"

# Prevent MIME type sniffing
# Header set X-Content-Type-Options "nosniff"

# Enable XSS protection
# Header set X-XSS-Protection "1; mode=block"

# Optional: Performance Settings
# Uncomment for production

# Enable compression for text files
# <IfModule mod_deflate.c>
#     AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
# </IfModule>

# Set cache headers for static assets
# <IfModule mod_expires.c>
#     ExpiresActive On
#     ExpiresByType image/jpg "access plus 1 year"
#     ExpiresByType image/jpeg "access plus 1 year"
#     ExpiresByType image/gif "access plus 1 year"
#     ExpiresByType image/png "access plus 1 year"
#     ExpiresByType text/css "access plus 1 month"
#     ExpiresByType application/javascript "access plus 1 month"
# </IfModule>

# Disable directory browsing
# Prevents users from seeing directory contents
Options -Indexes

# Set default charset
# Ensures proper character encoding
AddDefaultCharset UTF-8

# Custom error pages (optional)
# Uncomment and adjust paths as needed
# ErrorDocument 404 /error/404.php
# ErrorDocument 403 /error/403.php
# ErrorDocument 500 /error/500.php

# PHP Settings (if allowed by server)
# Uncomment if your server allows .htaccess PHP overrides
# php_value upload_max_filesize 10M
# php_value post_max_size 10M
# php_value max_execution_time 300
# php_value max_input_time 300
